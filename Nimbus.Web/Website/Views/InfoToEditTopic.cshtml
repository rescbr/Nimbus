@model Nimbus.Web.Website.Models.TopicModel

@Scripts.Render("~/Scripts/jquery.form.js")

<div id="divInfos">
    <p>Nome: <input id="iptNewTitle" value="@Model.CurrentTopic.Title" /></p>
    <p>Descrição:<input id="iptNewDescription" value="@Model.CurrentTopic.Description" /></p>
    <p>
        Imagem ilustrativa:
        <div id="divImgTopico">
            <img id="imgNewPrevia" src="@Model.CurrentTopic.ImgUrl" height="100" width="150" />
        </div>
    </p>
    <form action='/channel/upload' method="post" enctype="multipart/form-data" name="imagem_original">
        <input type="file" name="iptNewImgTopic" id="iptNewImgTopic" />
        <input type="submit" value="Carregar" class="hidden" style="display:none" id="upload" /><br />
        <label>Imagem de no máx. 5MB</label>
        <input type="hidden" id="url" name="url" />
    </form>

        @if(Model.CurrentTopic.TopicType == Nimbus.Model.Enums.TopicType.video)
        {            
            <div id="divEditVideo">               
                <input type="text" id="iptTitlevideo" name="iptTitlevideo" value="URL do vídeo" onfocus="javascript: this.value = ''" 
                       onchange="getUrlVideo(this.name, 'divFrameNewVideo', 'iframeNewVideo');" />
                <label>Somente url do youtube</label><br />
                <div id="divFrameNewVideo" style="display:none;">
                    <iframe name="iframeNewVideo" width="420" height="345" id="iframeNewVideo" src=""></iframe>
                </div>                
            </div>

        }
        else if (Model.CurrentTopic.TopicType == Nimbus.Model.Enums.TopicType.text ||
                 Model.CurrentTopic.TopicType == Nimbus.Model.Enums.TopicType.discussion)
        {
            <div id="divNewText">
                <textarea id="txtaArticle" required class="ckeditor">@Model.CurrentTopic.Text</textarea>
            </div>
        }
        else if (Model.CurrentTopic.TopicType == Nimbus.Model.Enums.TopicType.exam)
        {
            <div id="divNewExam">
                @for (int i = 0; i < Model.CurrentTopic.Question.Count; i++)
                {
                    var question = Model.CurrentTopic.Question[i];
                    var answers = question.ChoicesAnswer.ToList();

                    <section>
                        <p>Pergunta:</p>
                        <p><strong>@(i + 1)</strong> -<input type="text" value="@question.TextQuestion" /></p>

                        <p>Respostas:</p>
                        @foreach (var answer in answers)
                        {
                            //imprime as questoes
                            <input type="radio" name="@i" value="@answer.Key" /><input type="text" value="@answer.Value" /><br />
                        }
                    </section>
        
                    <p>Colocar p salvar</p>
                }    
            </div>
        }
    <div>
        <button value="Salvar" onclick="ajaxEditTopic(@Model.CurrentTopic.Id, '@Model.CurrentTopic.TopicType', 'divCurrent_@Model.CurrentTopic.TopicType')"> Salvar</button>
    </div>
</div>


<script type="text/javascript">
    $(document).ready(function () {

        $(document).on('change', 'input[name=iptNewImgTopic]', function () {
            $("#upload").click();
        });

        $('form[name=imagem_original]').ajaxForm({
            dataType: 'json',
            success: function (data) {
                $('input[name=url]').val(data.url);
                $("#imgNewPrevia").attr("src", data.url);
            }
        });
    });

</script>